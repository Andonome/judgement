\newcommand\encRef[1]{%
  \nameref{#1} (\autopageref{#1})%
}

\newcommand{\moralechart}{
  \begin{nametable}{Morale Chart}
    Bonus & Situation \\\hline

    +4 & Monsters outnumber characters 3:1. \\

    +2 & Monsters outnumber characters 2:1. \\

    +2 & Character's top Strength Bonus is lower than the monster's.  \\

    +2 & Monster is desperate or hungry.  \\

    -2 & Character's top Strength Bonus is higher than the monster's.  \\

    -2 & Characters outnumber the monsters. \\

    -2 & Monster is wounded. \\

    -1 & Players have displayed awesome magical abilities. \\

      \end{nametable}
}

% This is an array of encounters.

\newcommand\encBigList{
  \ifcase\value{enc}\relax
    \ifcase\value{track}\relax% Hot Seasons
      Flood
    \or
      Bandits
    \or
      Hot Spell
    \or
      Flood
    \else
      Peace
    \fi
  \or
    \ifcase\value{track}\relax% Hot + Mild Seasons
      Peace
    \or
      Traders
    \or
      Rain
    \or
      Peace
    \else
      Monster
    \fi
  \or
    \ifcase\value{track}\relax% All Seasons
      Traders
    \or
      Broken Path
    \or
      Storm
    \or
      Peace
    \else
      Monster
    \fi
  \or
    \ifcase\value{track}\relax% Mild + Cold Seasons
      Peace
    \or
      Bandits
    \or
      Peace
    \or
      Monster
    \else
      Peace
    \fi
  \else
    \ifcase\value{track}\relax% Mild + Cold Seasons
      Peace
    \or
      Icy Roads
    \or
      Heavy Snow
    \or
      Peace
    \else
      Peace
    \fi
  \fi
}

\newcommand\encWarmVillages{
  \begin{nametable}[l|YYY]{Villages}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{0}
    \setcounter{track}{0}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encWarmEdge{
  \begin{nametable}[l|YYY]{Edge}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{0}
    \setcounter{track}{1}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encWarmForest{
  \begin{nametable}[l|YYY]{Forest}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{0}
    \setcounter{track}{2}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encMildVillages{
  \begin{nametable}[l|YYY]{Villages}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{1}
    \setcounter{track}{0}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encMildEdge{
  \begin{nametable}[l|YYY]{Edge}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{1}
    \setcounter{track}{1}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encMildForest{
  \begin{nametable}[l|YYY]{Forest}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{1}
    \setcounter{track}{2}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encColdVillages{
  \begin{nametable}[l|YYY]{Villages}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{2}
    \setcounter{track}{0}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{0}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encColdEdge{
  \begin{nametable}[l|YYY]{Edge}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{2}
    \setcounter{track}{1}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{1}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}

\newcommand\encColdForest{
  \begin{nametable}[l|YYY]{Forest}
    & \dicef[\Large]{1} & \dicef[\Large]{2} & \dicef[\Large]{3} \\
    \hline
    \setcounter{enc}{2}
    \setcounter{track}{2}
    \dicef[\Large]{1} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{2} \Repeat{3}{& \encBigList \stepcounter{track} } \\
    \stepcounter{enc}
    \setcounter{track}{2}
    \dicef[\Large]{3} \Repeat{3}{& \encBigList \stepcounter{track} } \\
  \end{nametable}
}


\newcommand\showBandits{
  \item
  \setcounter{gold}{\value{diceNo}}
  \multiply\value{gold} by 2
  \addtocounter{gold}{4}
  \arabic{gold} \ifodd\value{diceNo}
    Brigands
  \else
    Bandits
  \fi
}

\newcommand\encBandits{
  \begin{multicols}{2}
  \begin{dlist}
    \showBandits
    \showBandits
    \showBandits
    \showBandits
    \showBandits
    \showBandits
  \end{dlist}
  \end{multicols}
}

\newcommand\encPeace{
  \begin{boxtable}[cccL]
    \textbf{Cold} & \textbf{Mild} & \textbf{Hot}  & \textbf{Encounter} \\
    \hline
    \dicef{1} &           &           & Hibernating \encRef{chitincrawler}  \\
    \dicef{2} & \dicef{1} &           & Deer               \\
    \dicef{3} & \dicef{2} & \dicef{1} & \encRef{auroch}    \\
    \dicef{4} & \dicef{3} & \dicef{2} & \encRef{boar}      \\
    \dicef{5} & \dicef{4} & \dicef{3} & \encRef{mage_oak}  \\
    \dicef{6} & \dicef{5} & \dicef{4} & \encRef{uproot}    \\
              & \dicef{6} & \dicef{5} & \encRef{bedleaves} \\
              &           & \dicef{6} & \encRef{seekers}   \\
  \end{boxtable}
}

\newcommand\encTraders{
  \begin{multicols}{2}
  \begin{dlist}
    \item
    Wine.
    \item
    Bows and arrows of all sizes, and a couple of crossbows.
    \item
    Pitch (to make torches).
    \item
    Salted meats.
    \item
    Silks.
    \item
    A live monster (roll on the Monster chart, with the Hot Season results).
  \end{dlist}
  \end{multicols}
}

\newcommand\encMonsters{
    \begin{boxtable}[cccL]
      \textbf{Cold} & \textbf{Mild} & \textbf{Hot}  & \textbf{Encounter} \\
      \hline
      \dicef{1} &           &           & \encRef{ghast}                                                     \\
      \dicef{2} &           &           & \encRef{wolf}                                                      \\
      \dicef{3} & \dicef{1} &           & \encRef{dryad}                                                     \\
      \dicef{4} & \dicef{2} & \dicef{1} & \encRef{griffin}                                                   \\
      \dicef{5} & \dicef{3} & \dicef{2} & \encRef{bear}                                                      \\
      \dicef{6} & \dicef{4} & \dicef{3} & \encRef{woodspy}                                                   \\
      \dicef{5} & \dicef{5} & \dicef{4} & \encRef{mouthdigger}                                               \\
                & \dicef{6} & \dicef{5} & \encRef{chitincrawler}                                             \\
                & \dicef{6} & \dicef{6} & \encRef{basilisk}                                                  \\
                &           & \dicef{6} & \encRef{umber_hulk}                                                \\

    \end{boxtable}
}

